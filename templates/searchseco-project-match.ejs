<%#
This program has been developed by students from the bachelor Computer Science at
Utrecht University within the Software Project course.
Â© Copyright Utrecht University (Department of Information and Computing Sciences)
 %>

<%
    function showAuthors(authors) {
        if (authors.length === 0) {
            return "Authors unknown"
        } else if (authors.length === 1) {
            return "Author: " + authors[0];
        } else {
            let str = "Authors: ";
            for (let i = 0; i < authors.length - 1; i++) {
                str += authors[0] + ", ";
            }
            return str + authors[authors.length - 1];
        }
    }
%>
<div class="SearchSECO__Match<%- match.vuln.code === -1 ? ' SearchSECO--NotVulnerable' : '' %>">
    <div class="SearchSECO__Match__Header">
        <h2><%- match.data.name %> (<%- match.data.file %>:<%- match.data.line %>)</h2>
        <%- match.vuln.code !== -1 ? '<span><i class="fa-solid fa-circle-exclamation"></i> Vulnerability reported</span>' : '' %>
    </div>
    <%- showAuthors(match.data.authors)%>
    <br>
    <br>
    <h3>Matches your <%- yourMethod.data.name %> (<%- yourMethod.data.file %>:<%- yourMethod.data.line %>)</h3>
    <%- showAuthors(yourMethod.data.authors) %>
    <% if (match.vuln.code !== -1) { %>
        <br>
        <br>
        <span><i class="fa-solid fa-circle-exclamation"></i> Vulnerability <%- match.vuln.code %> reported: <a href="<%- match.vuln.url %>"><%- match.vuln.url %></a></span> 
    <% } %>
</div>